node {

    echo "Running build#${env.BUILD_ID} on ${env.JENKINS_URL}"

    stage('checkout code') {
        checkout scm
    }
    stage('Build') {
        echo 'Building...'
    }
    stage('Test') {
        withEnv([M2_HOME=${tool 'maven'}]) {
        def process = "Testing"
            echo "${process}..."
                sh 'mvn test'
            }
    }
    stage('Deploy') {
        echo 'Deploying...'
    }
}