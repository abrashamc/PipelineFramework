node {

    echo "Running build#${env.BUILD_ID} on ${env.JENKINS_URL}"

    stage('checkout code') {
        checkout scm
    }
    stage('Build') {
        echo 'Building...'
    }
    stage('Test') {
        withEnv(['M2_HOME=/usr/local/Cellar/maven/3.5.2/libexec']) {
        def process = "Testing"
            echo "${process}..."
                sh 'mvn test'
            }
    }
    stage('Deploy') {
        echo 'Deploying...'
    }
}